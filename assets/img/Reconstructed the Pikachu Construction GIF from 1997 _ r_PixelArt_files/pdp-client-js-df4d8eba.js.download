import"./open-interstitial-modal-c2afc398.js";import"./confirm-over-18-7844be6c.js";import{i as t,_ as e,n as i,j as o,s,x as r,cw as n,h as a,cI as p,I as c}from"./icon-29bbe755.js";import"./faceplate-modal-f4c056ae.js";import"./reddit-page-data-bc6db710.js";import"./shreddit-ad-post-3e464a35.js";import"./shreddit-comments-page-ad-0a4c0610.js";import{t as d,d as l,g6 as m,g7 as h,b as f,_ as u}from"./shell-38e4146f.js";import"./shreddit-tweet-embed-29c832e3.js";import"./faceplate-tabgroup-9f2cff7e.js";import"./faceplate-tabpanel-15052681.js";import"./faceplate-shimmer-465c99ff.js";import"./comment-body-header-e54209de.js";import"./protected-community-modal-trigger-dba65ec6.js";import"./faceplate-dropdown-menu-13cc41dc.js";import"./faceplate-menu-f85d1ee9.js";import"./author-flair-event-handler-5979f3fa.js";import"./mod-notes-opener-68f246b5.js";import"./rpl-dialog-trigger-6fc96c17.js";import"./guard-community-modal-0ccd8b7c.js";import"./chat-channel-recommendations-wrapper-ece4ee56.js";import"./rpl-bottom-sheet-d9704438.js";import"./index-4715c008.js";import"./index-4388f44a.js";import"./shreddit-dynamic-ad-link-b1b66e36.js";import"./events-82e64833.js";import"./pixels-c1c2b80f.js";import"./ad-listeners-88a2fe00.js";import"./activate-lead-gen-dialog-5481e49f.js";import"./content-action-button-607176e1.js";import"./shreddit-post-02714599.js";import"./faceplate-date-7edf5099.js";import"./locale-e49f0b05.js";import"./faceplate-number-aa3b71c1.js";import"./number-ea0536b9.js";import"./cached-intl-e5b35306.js";import"./index-64cc986f.js";import"./award-controller-37234f0f.js";import"./award-d2cbc0ed.js";import"./index-e62e400a.js";import"./utils-75a02ea9.js";import"./awardsTelemetryState-3fb708c7.js";import"./faceplate-tooltip-8723976a.js";import"./popper-controller-267df72e.js";import"./makeEventDispatcher-ddce7d90.js";import"./content-tags-205aa849.js";import"./postUpdate-a3d942b6.js";import"./modActions-112bd6f6.js";import"./shreddit-post-share-button-84a31c53.js";import"./list-item-290baf48.js";import"./with-share-8052785d.js";import"./a-9b2aeae6.js";import"./index-6b6f75e3.js";import"./mod-actions-controller-691ac8db.js";import"./custom-event-8a5c1c61.js";import"./add-removal-reason-modal-7802a6ef.js";import"./modActions-b6ac3bac.js";import"./keyed-585a9756.js";import"./faceplate-form-0ead5440.js";import"./form-common-utils-52a96849.js";import"./comment-b3876d6b.js";import"./post-c7a2ad6d.js";import"./post-69fe4f77.js";import"./faceplate-input-6da71712.js";import"./input-element-5b4d45e2.js";import"./dropdownButton-309f6234.js";import"./faceplate-textarea-input-02098dd3.js";import"./live-13af0347.js";import"./text-input-b548c0bb.js";import"./constants-17b30c47.js";import"./icon-checkmark-87dbeb55.js";import"./remove-highlighted-post-9a3317a9.js";import"./utils-147dae00.js";import"./pdp-6efc7815.js";import"./throttle-cde4a556.js";import"./click-card-af8e865e.js";import"./faceplate-hovercard-4b61c288.js";import"./outbound-link-tracking-controller-13b8ddb2.js";import"./promote-post-button-0e4d8cea.js";import"./utils-34fce734.js";import"./overflow-menu-actions-8ed9e6ba.js";import"./shreddit-overflow-report-12713898.js";import"./classnameUtils-e77f7123.js";import"./mod-verdict-fe58380e.js";import"./faceplate-carousel-clone-812cf40e.js";import"./faceplate-pagination-indicator-d59cdf1c.js";import"./TinyGesture-6f7cc1aa.js";import"./index-b5439860.js";import"./faceplate-tablist-3e2e6bea.js";import"./pageable-832f4cce.js";import"./comment-composer-host-eb95c94b.js";import"./rte-toolbar-button-emote-c1f14026.js";import"./mention-node-d2d1a9a8.js";import"./upload-af3134f0.js";import"./upload-to-s3-2da7bd68.js";import"./postComposerFields-99c30dc1.js";import"./translations-80aaf823.js";import"./faceplate-checkbox-input-e8cb9934.js";import"./checked-input-element-49c8b895.js";import"./automation-rule-triggered-rules-04e40739.js";import"./filterNullish-14d2de97.js";import"./avatar-6a32efda.js";import"./rtjson-e5eac1b0.js";import"./dom-37d48515.js";import"./reputation-recaptcha-412654c1.js";import"./sleep-a1fd43c3.js";import"./faceplate-progress-616641b8.js";import"./telemetry-event-struct-fef69997.js";import"./commentsPage-b2353abd.js";import"./mod-notes-6691414f.js";const j=t=>t.replace(/\n/g,"").replace(/\s+/g," ").trim(),b=({commentId:t,noPrefix:e})=>{let i=t.replace("-comment-rtjson-content","");return e&&(i=i.replace("t1_","")),i},g=({commentId:t,permalink:e,snippetData:i})=>t?`https://publish.reddit.com/embed?url=https://www.reddit.com${e.replace(/\/[^/]+(?=\/$)|\/$/,"")}comment/${b({commentId:t,noPrefix:!0})}?snippet=${i}`:`https://publish.reddit.com/embed?url=https://www.reddit.com${e}?snippet=${i}`,x=["TR","TH","TD","TABLE","TBODY","THEAD"],T=new Set(["H1","P"]);let v=class extends s{constructor(){super(...arguments),this.postId="",this.permalink="",this.topOffset=0,this.leftOffset=0,this.snippetData="",this.isTitleSelected=!1,this.isSelectionOutOfRange=!1,this.isFullTextSelected=!1,this.isComment=!1,this.clearSelection=t=>{if(2!==t.button&&t.target.getAttribute("postid")!==this.postId){const e=((t,e)=>{for(;t;){if(t.id&&(t.id.includes(`${e}-post-rtjson-content`)||t.id.includes("-comment-rtjson-content")))return t;t=t.parentNode}return null})(t.target,this.postId);this.richTextContainer=e,getSelection()?.empty(),this.snippetData="",this.isTitleSelected=!1,this.isSelectionOutOfRange=!1,this.isFullTextSelected=!1}},this.handleEmbedClick=()=>{this.isComment&&this.richTextContainer?.id?open(g({commentId:this.richTextContainer?.id,permalink:this.permalink,snippetData:this.snippetData}),"RedditEmbed"):open(g({permalink:this.permalink,snippetData:this.snippetData}),"RedditEmbed"),this.sendClickTelemetry()},this.isTripleClickHandled=t=>3===t.detail,this.getChildTextNode=t=>{let e;const i=t.childNodes;for(let t=0;t<i.length;t++){const o=i[t];if("#text"!==o.nodeName)continue;0!==j(o.textContent||"").length&&(e=o)}return e},this.getCorrectSelection=t=>{const e=getSelection();if(this.isTripleClickHandled(t)&&e?.anchorNode?.nodeName&&T.has(e?.anchorNode?.nodeName)){const t=this.getChildTextNode(e.anchorNode),i=t?.textContent?.length||0;e.setBaseAndExtent(t,0,t,i)}return e},this.calculateSnippetData=t=>{if(this.shouldShowButton)return void this.clearSelection(t);this.isComment=Boolean(this.richTextContainer?.id&&this.richTextContainer.id.startsWith("t1")),this.snippetData="";const e=this.getCorrectSelection(t),i=j(e?.toString()||"");if(!e||!i?.length)return;const o=this.richTextContainer?j(this.richTextContainer.innerText):"",s=j(this.postTitleElement.innerText);this.richTextContainer&&i===o&&(this.isFullTextSelected=!0);const r=e?.anchorNode;if(r.parentNode?.nodeName&&x.includes(r.parentNode?.nodeName))return;const n=e.getRangeAt(0);r.parentNode===this.postTitleElement&&(this.isTitleSelected=!0),(this.isTitleSelected&&i.length>s.length||this.richTextContainer&&i.length>o.length)&&(this.isSelectionOutOfRange=!0);const a=this.isTitleSelected?this.postTitleElement?.getBoundingClientRect():this.richTextContainer?.getBoundingClientRect(),p=e?.getRangeAt(0).getBoundingClientRect();if(a&&p){if(this.topOffset=p.top+scrollY,this.leftOffset=p.left+p.width/2,this.shadowRoot?.host.style.setProperty("--left-offset",`${this.leftOffset}px`),this.shadowRoot?.host.style.setProperty("--top-offset",this.topOffset-32-4+"px"),this.isTitleSelected||this.isFullTextSelected)return void this.sendViewTelemetry();if(e.rangeCount>0){let t=-1;const e=Array.from((this.isComment?this.richTextContainer?.children[0].children:this.richTextContainer?.children)||[]).filter((t=>"#text"!==t.nodeName));for(let i=0;i<e.length;i++){const o=e[i];if(n.intersectsNode(o)){t=i;break}}if(-1!==t&&i){const o=(({nodeText:t,selectedText:e})=>{if(!t||!e)return-1;const i=t.length,o=e.length,s=[];for(let t=0;t<=i;t++)s[t]=new Array(o+1).fill(0);let r=0,n=0;for(let a=1;a<=i;a++)for(let i=1;i<=o;i++)t[a-1]===e[i-1]&&(s[a][i]=s[a-1][i-1]+1,s[a][i]>r&&(r=s[a][i],n=a-1));const a=t.substring(n-r+1,n+1);return a?t.indexOf(a):-1})({nodeText:j(e[t].innerText),selectedText:i});t>-1&&o>-1&&i.length>0&&(this.snippetData=`${t}_${o}_${i.length}`,this.sendViewTelemetry())}}}},this.getEventDetails=()=>{const t={};return this.isComment&&this.richTextContainer?.id&&(t.comment={id:b({commentId:this.richTextContainer.id})}),t},this.sendViewTelemetry=()=>{const t=this.getEventDetails();this.dispatchEvent(l(m,{details:t}))},this.sendClickTelemetry=()=>{const t=this.getEventDetails();this.dispatchEvent(l(h,{details:t}))}}get shouldShowButton(){return(this.snippetData.length||this.isTitleSelected||this.isFullTextSelected)&&!this.isSelectionOutOfRange}connectedCallback(){super.connectedCallback();const t=document.getElementById(`post-title-${this.postId}`);t&&(this.postTitleElement=t),document.addEventListener("mousedown",this.clearSelection),document.addEventListener("mouseup",this.calculateSnippetData)}disconnectedCallback(){super.disconnectedCallback(),document.removeEventListener("mousedown",this.clearSelection),document.removeEventListener("mouseup",this.calculateSnippetData)}render(){return r`\n ${this.shouldShowButton?r`\n <div class="button-container bg-neutral-content-strong rounded-full shadow-sm flex">\n ${f({appearance:"plainInverted",size:u.Small,attributes:{onclick:this.handleEmbedClick},leadingIcon:n(),children:"Embed"})}\n </div>\n `:""}\n `}};v.styles=[t`.button-container{position:absolute;left:var(--left-offset);top:var(--top-offset);transform:translateX(-50%);z-index:1}`,d],e([i({type:String})],v.prototype,"postId",void 0),e([i({type:String})],v.prototype,"permalink",void 0),e([o()],v.prototype,"topOffset",void 0),e([o()],v.prototype,"leftOffset",void 0),e([o()],v.prototype,"snippetData",void 0),e([o()],v.prototype,"isTitleSelected",void 0),e([o()],v.prototype,"isSelectionOutOfRange",void 0),e([o()],v.prototype,"isFullTextSelected",void 0),e([o()],v.prototype,"isComment",void 0),v=e([a("embed-snippet-share-button")],v);let C=class extends s{constructor(){super(...arguments),this.replaceItselfWithChildren=()=>{this.replaceWith(...this.childNodes)}}render(){return r`<div class="mx-md xs:mx-0">\n <div \n class="items-center justify-between flex flex-row py-sm px-md w-100 bg-neutral-background border-neutral-border rounded-[8px] border-solid border box-border" \n>\n <div>\n ${p({size:c.Medium,attributes:{className:"align-middle mr-2xs"}})}\n <span class="text-neutral-content-weak">\n Posted by a blocked account\n </span>\n </div>\n\n ${f({appearance:"secondary",size:u.Small,attributes:{rel:"nofollow",id:"primary-button",onclick:this.replaceItselfWithChildren},children:"View Post"})}\n </div>\n </div>`}};C.styles=[d],C=e([a("shreddit-blocked-post-content")],C),import("./faceplate-hovercard-4b61c288.js").then((function(t){return t.f})),import("./faceplate-progress-616641b8.js"),import("./faceplate-tooltip-8723976a.js");
//# sourceMappingURL=pdp-client-js-df4d8eba.js.map
