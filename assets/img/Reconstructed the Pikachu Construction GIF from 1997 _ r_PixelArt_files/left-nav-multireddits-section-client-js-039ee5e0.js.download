import"./faceplate-expandable-section-helper-91b10ded.js";import"./faceplate-shimmer-465c99ff.js";import{x as t,J as e,I as i,b$ as a,c0 as s,_ as r,s as o,n as d,h as n,aP as l,j as c}from"./icon-29bbe755.js";import{W as h,a as p,h as u,dE as m,a4 as v,a5 as f,k as g,d as F,S,t as y,b,_ as N,M as C}from"./shell-38e4146f.js";import{l as $,L as k}from"./list-item-290baf48.js";import{C as x,a as P}from"./index-3b6330bf.js";import"./custom-feed-edit-button-832ebe36.js";let _=class extends(h(p(o))){constructor(){super(...arguments),this.multiredditPath="",this.displayName="",this.iconSrc="",this.isFavorited=!1,this.sanNoun="",this.getTrackingContext=()=>({customFeed:{id:this.multiredditPath}}),this.onFavoriteClick=async()=>{this.trackEvent(u({source:"community_nav",action:"click",noun:this.isFavorited?"unfavorite":"favorite"},this.getTrackingContext()));try{const t={input:{label:this.multiredditPath,favoriteState:this.isFavorited?m.None:m.Favorited}},{data:e}=await v({operation:f.UpdateMultiredditFavoriteState,variables:t});if(e.updateMultiredditFavoriteState?.ok){const t={path:this.multiredditPath,isFavorited:!this.isFavorited};return void this.publish(g.MultiredditFavoriteStatusChange,t)}throw new Error("error updating custom feed favorite status")}catch(t){const e=this.isFavorited?`Failed to remove ${this.displayName} from favorites`:`Failed to add ${this.displayName} to favorites`;this.dispatchEvent(F("faceplate-alert",{level:S.error,message:e}))}}}static get styles(){return[y]}updated(t){}render(){const r=t`<span class="mr-[2px]" \n>${this.iconSrc?t`<img \n class="rounded-full" \n loading="lazy" \n src="${this.iconSrc}" \n width="32" \n height="32" \n aria-hidden="true" \n alt="custom feed icon" \n>`:e({size:i.Large})}</span>`;return t`<faceplate-tracker \n source="${"community_nav"}" \n action="click" \n noun="custom_feed" \n data-faceplate-tracking-context="${JSON.stringify(this.getTrackingContext())}" \n>${$({href:this.multiredditPath,innerClassName_DO_NOT_USE:"s:rounded-[8px] bg-transparent",label:t`<div class="truncate">${this.displayName}</div>`,leadingAvatar:r,size:k.Small,trailingSlot:t` ${b({appearance:"plain",leadingIcon:(this.isFavorited?a:s)({size:i.Small}),size:N.Small,attributes:{"aria-label":this.isFavorited?"Remove custom feed from favorites":"Add custom feed to favorites",onclick:t=>{t.preventDefault(),t.stopPropagation(),this.onFavoriteClick()}}})}`})}</faceplate-tracker>`}};r([d({type:String})],_.prototype,"multiredditPath",void 0),r([d({type:String})],_.prototype,"displayName",void 0),r([d({type:String})],_.prototype,"iconSrc",void 0),r([d({type:Boolean})],_.prototype,"isFavorited",void 0),r([d({type:String})],_.prototype,"sanNoun",void 0),_=r([n("left-nav-multireddit-item")],_);class j extends(p(o)){constructor(){super(),this.initialStateJSON="[]",this.items=[],this.triggerReload=()=>{this.dispatchEvent(new CustomEvent(x))},this.updateFavoritedState=({path:t,isFavorited:e})=>{const i=[...this.items],a=i.findIndex((e=>e.path===t));-1!==a&&i[a].isFavorited!==e&&(i[a].isFavorited=e,this.items=w(i))},this.reloadController=new P(this,{reloadUrl:"/svc/shreddit/left-nav-multireddits-section",containerSelector:"left-nav-multireddits-controller",mode:C.Replace})}connectedCallback(){super.connectedCallback(),this.items=w(JSON.parse(this.initialStateJSON)),this.subscribe(g.MultiredditFavoriteStatusChange,this.updateFavoritedState),this.subscribe(g.CustomFeedUpdated,this.triggerReload,!1),this.subscribe(g.CustomFeedCreated,this.triggerReload,!1),this.subscribe(g.CustomFeedDeleted,this.triggerReload,!1)}render(){return t`<div>\n ${this.reloadController?.isLoading?t`<shreddit-loading></shreddit-loading>`:t`${l(this.items,(e=>t`<left-nav-multireddit-item \n sanNoun="${this.sanNoun}" \n multiredditPath="${e.path}" \n displayName="${e.displayName}" \n iconSrc="${e.icon}" \n ?isFavorited="${e.isFavorited}" \n></left-nav-multireddit-item>`))}`}\n </div>`}}function w(t){return[...t.sort(((t,e)=>t.isFavorited===e.isFavorited?t.displayName.toLowerCase()>e.displayName.toLowerCase()?1:-1:t.isFavorited?-1:1))]}r([d({type:String})],j.prototype,"initialStateJSON",void 0),r([c()],j.prototype,"items",void 0);let E=class extends j{constructor(){super(...arguments),this.sanNoun="multireddits_menu"}};E=r([n("left-nav-multireddits-controller")],E);
//# sourceMappingURL=left-nav-multireddits-section-client-js-039ee5e0.js.map
